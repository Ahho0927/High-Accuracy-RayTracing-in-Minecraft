<h1 align="center">RAYTRACING</h1>
<p align="center">How can raytracing be perfectly accurate in Minecraft?</p>

# 개요

광선 추적 또는 레이 트레이싱(Ray Tracing)은 가상적인 광선이 물체의 표면에서 반사되어, 카메라를 거쳐 다시 돌아오는 경로를 계산하는 것이다. 보통의 경우 그래픽 작업에서 많이 사용되어 반사된 경로까지 계산해야 하지만, 현재로써는 블럭과의 충돌만을 계산하기 위함을 목표로 한다.

# 방법/원리

가장 간단하고 대표적인 방법으로는 특정 방향으로 Entity(대체로 Marker)를 보내 일정 간격마다 블럭과 충돌했는지 감지하는 방법이 있다. 하지만 이와 같은 방법은 그 일정 간격 때문에 광선의 경로 중 무시하고 지나가는 부분이 존재할 수밖에 없어 대각선으로 놓여 있는 블럭을 통과할 가능성이 있다.

이러한 문제를 해결하기 위해선 다른 차원의 방식으로 수학적 접근을 사용하여야 한다.
기본적인 원리는 광선 궤도의 직선 방정식을 활용해 한 축에 대한 각 축의 좌푯값을 계산하여 해당 위치의 블럭을 감지하는 형식이다.

## 세부 설명

입체 공간에서 하나의 직선을 한 축에 대한 두 개의 평면 직선으로 나누어 계산하였다.

순서는 다음과 같다.
1. 광선을 쏘는 위치를 시작점으로하는 광선을 쏘는 방향의 단위벡터 좌푯값을 구한다.

   1. 바라보는 방향으로 1블럭 떨어져 있는 곳의 좌표에서 시작점의 좌표를 빼서 위치 변화량을 구한다. (10000배수)

2. x와 z의 위치 변화량과 쏜 방향의 y각도를 토대로 방향과 가장 가까운 축(진행축)을 정한다.

   1. x와 z의 위치 변화량 중 값이 더 큰 축을 진행축으로 정한다.

   2. y각도의 절댓값이 45 초과일 때, y축을 진행축으로 정한다.

   3. 진행축의 값을 진행축의 값의 절댓값으로 나눈 값을 진행축 부호로 정한다.

3. 진행축에 대한 진행축이 아닌 축의 직선 함수를 계산한다.

   1. ```진행축이 아닌 축의 결괏값 = (진행축이 아닌 축의 위치 변화량 / 진행축의 위치 변화량) * (진행축 - 진행축의 시작점 좌푯값) + 진행축이 아닌 축의 시작점 좌푯값```

   2. 두 진행축이 아닌 축에 대해 위의 식을 대입하여 구한다.

4. 나온 좌푯값을 토대로 감지해야 할 블럭을 정한다.

   1. 좌푯값을 진행축 방향으로 0.5블럭 옮긴 위치를 감지한다.

   2. 진행축이 아닌 축의 좌푯값에서 바로 전 좌푯값의 가우스 값과 현재 좌표의 가우스 값의 차가 1이면, 이전 좌푯값에 진행축으로 1을 더한 좌표의 블럭도 감지해야 한다. 

5. 블럭이 감지되면 종료한다.

6. 3 ~ 4의 과정을 원하는 길이만큼 반복한다.

# 단점